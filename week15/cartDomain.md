## 장바구니 도메인

## Aggregate
> Aggregate는 도메인 모델의 일부로서, 하나의 개념적인 단위로 묶여 있는 객체들의 집합이다.
- 트랜잭션 일관성을 유지하고 도메인 규칙을 적용하며 도메인 모델을 캡슐화하는 단위다.
- 4가지 경험 법칙
    1. 불변식을 통해 일관성 경계를 찾아서 모델링한다. Aggregate은 트랜잭션적 일관성 경계와 동의어다.
    2. 작은 Aggregate으로 설계한다.
    3. ID로 다른 Aggregate을 참조한다. JPA 등을 사용하면 관련된 객체를 모두 직접 참조할 수 있게 되는데, 그렇게 하지 않는다.
    4. 경계 밖에선 결과적 일관성을 사용한다. 이를 위해 도메인 이벤트 등을 사용할 수 있다.      
<br>
- 쉽게 말하면 묶여서 함께 처리되어야 하는 객체들의 집합이다.

### Aggregate Root
> 집합체에 대한 진입점 역할
- 집합체에 속한 객체들은 집합체의 불변식을 지키기 위해 집합체 루트를 통해서만 접근할 수 있다.
### Consistency Boundary
> 집합체의 불변식을 지키기 위한 경계
- 집합체의 모든 작업은 원자적이어야 한다.
- 전체 작업이 성공하거나, 일부 작업이 실패하면 모두 이전 상태로 돌아가야 한다.
## 불변식
> 불변식은 집합체의 불변성을 보장하는 규칙이다.
- 비즈니스 규칙에 따라 도메인 모델이 일관되고 유효하게 유지되는 조건을 정의한다.
- 집합체 단위로 불변식을 정의한다.
- Aggregate Root는 불변식을 지키기 위한 경계를 정의한다.
## 트랜잭션적 일관성과 결과적 일관성
> 트랜잭션 일관성 : 데이터가 변경되면 즉시 다음 읽기 작업에 반영되도록 보장한다.
>
> 결과적 일관성 : 데이터가 변경되면 충분한 시간이 주어지고 최종적으로 모두 일관된 상태로 수렴하도록 보장한다.
- 트랜잭션 일관성은 즉각적인 데이터 일관성을 보장하지만 시스템 가용성 및 성능에 영향을 미칠 수 있다.
- 반면 결과적 일관성은 애플리케이션 논리에서 처리하기 어려울 수 있는 일시적인 불일치를 대가로 시스템 가용성 및 성능을 최적화합니다.