# 객체지향 프로그래밍

## 1. 영화 예매 시스템

### 요구사항 살펴보기
- 이번 장에서 소개할 예제는 온라인 영화 예매 시스템이다.
- `영화`는 영화에 대한 기본 정보를 표현한다.
- `상영`은 실제로 관객들이 영화를 관람하는 사건을 표현한다.


- 두 용어의 차이가 중요한 이유는 사용자가 실제로 예매하는 대상은 영화가 아니라 상영이기 때문이다.
- 사람들은 영화를 예매한다고 표현하지만 실제로는 특정 시간에 상영되는 영화를 관람할 수 있는 권리를 사는 것이다.


- 특정한 조건을 만족하는 예매자는 요금을 할인받을 수 있다.
- 두 가지 규칙이 존재하는데, 하나는 `할인 조건(Discount Condition)`이고 다른 하나는 `할인 정책(Discount Policy)`이다.


- 할인 조건은 가격의 할인 여부를 결정하며, `순서 조건`과 `기간 조건` 두 종류로 나눌 수 있다.
- 순서 조건은 상영 순번을 이용해 할인 여부를 결정하는 규칙이다.
- 예를 들어 순번이 10이면 10번째로 상영되는 영화를 예매한 사용자들에게 할인 혜택을 제공한다.
- 기간 조건은 영화 상영 시작 시간을 이용해 할인 여부를 결정한다.
- 기간 조건은 요일, 시작 시간, 종료 시간의 세 부분으로 구성되며 영화 시작 시간이 해당 기간에 포함되면 할인한다.


- 할인 정책은 할인 요금을 결정하며, `금액 할인 정책`과 `비율 할인 정책`이 있다.
- 금액 할인 정책은 일정 금액을 할인해주는 방식이다.
- 비율 할인 정책은 정가에서 일정 비율의 금액을 할인해주는 방식이다.
- 영화별로 하나의 할인 정책만 할당할 수 있다.
- 할인 조건은 다수의 할인 조건을 함께 지정할 수 있다.


## 2. 객체지향 프로그래밍을 향해

### 협력, 객체, 클래스
- 객체지향은 객체를 지향하는 것이다.
- 이 말이 당연하다고 생각된다면 어떤 방식으로 프로그래밍하고 있는지 떠올려 보자.
- 대부분의 사람들은 클래스를 결정한 후에 클래스에 어떤 속성과 메서드가 필요한지 고민한다.


- 안타깝게도 이것은 객체지향의 본질과는 거리가 멀다.
- 진정한 객체지향 패러다임으로의 전환은 클래스가 아닌 객체에 초점을 맞출 때에만 얻을 수 있다.


- 첫째, 어떤 클래스가 필요한지를 고민하기 전에 어떤 객체들이 필요한지 고민하라.
- 클래스의 윤곽을 잡기 위해서는 어떤 객체들이 어떤 상태와 행동을 가지는지를 먼저 결정해야 한다.


- 둘째, 객체를 독립적인 존재가 아니라 기능을 구현하기 위해 협력하는 공동체의 일원으로 봐야 한다.
- 객체를 협력하는 공동체의 일원으로 바라보는 것은 설계를 유연하고 확장 가능하게 만든다.
- 객체들의 모양과 윤곽이 잡히면 공통된 특성과 상태를 가진 객체들을 타입으로 분류하고 이 타입을 기반으로 클래스를 구현하라.


### 도메인의 구조를 따르는 프로그램 구조
- 이 시점에서 `도메인(domain)`이라는 용어를 살펴보자
- 문제를 해결하기 위해 사용자가 프로그램을 사용하는 분야를 도메인이라고 부른다.


- 객체지향 패러다임이 강력한 이유는 요구사항을 분석하는 초기 단계부터 프로그램을 구현하는 마지막 단계까지 객체라는 동일한 추상화 기법을 사용할 수 있기 때문이다.
- 요구사항과 프로그램을 객체라는 동일한 관점에서 바라볼 수 있기 때문에 도메인을 구성하는 개념들이 프로그램의 객체와 클래스로 매끄럽게 연결될 수 있다.


- 자바나 C# 같은 클래스 기반의 객체지향 언어에 익숙하다면 도메인 개념들을 구현하기 위해 클래스를 사용한다는 사실이 낯설지는 않을 것이다.
- 일반적으로 클래스의 이름은 대응되는 도메인 개념의 이름과 동일하거나 적어도 유사하게 지어야 한다.
- 클래스 사이의 관계도 최대한 도메인 개념 사이에 맺어진 관계와 유사하게 만들어서 이해하고 예상하기 쉽게 만들어야 한다.


### 클래스 구현하기
- Screening 클래스는 사용자들이 예매하는 대상인 상영을 구현한다.
- Screening 클래스는 상영할 영화, 순번, 상영 시작 시간을 인스턴스 변수로 포함한다.
- Screening은 상영 시작 시간을 변환하는 getStartTime 메서드, 순번의 일치 여부를 검사하는 IsSequence 메서드, 기본 요금을 반환하는 getMovieFee 메서드를 제공한다.

```java
public class Screening {
    private Movie movie;
    private int sequence;
    private LocalDateTime whenScreened;
    
    public Screening(Movie movie, int sequence, LocalDateTime whenScreened) {
        this.movie = movie;
        this.sequence = sequence;
        this.whenScreened = whenScreened;
    }
    
    public LocalDateTime getStartTime() {
        return whenScreened;
    }
    
    public boolean isSequence(int sequence) {
        return this.sequence == sequence;
    }
    
    public Money getMovieFee() {
        return movie.getFee();
    }
}
```