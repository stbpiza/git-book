# 쿼리 작성 및 최적화

## 11.1 쿼리 작성과 연관된 시스템 변수

### 영문 대소문자 구분
- MySQL 서버는 설치된 운영체제에 따라 테이블명의 대소문자를 구분한다.
- 테이블명을 대소문자 구분 없이 사용하려면 `lower_case_table_names` 시스템 변수를 1로 설정한다.
- 기본적으로 테이블을 생성할 때 대문자 또는 소문자로 통일해서 사용하는 편이 좋다.

### 리터럴 표기법 문자열

#### 문자열
- SQL 표준에서 문자열은 항상 ''를 사용해서 표시한다.
- 하지만 MySQL에서는 ""를 사용해 표기할 수도 있다.
- ``를 사용하면 예약어와의 충돌을 피할 수 있다.

#### 숫자
- 숫자를 상수로 사용할때는 숫자만 사용하면 된다.
- MySQL은 숫자 타입과 문자열 타입 간 비교에서 숫자 타입을 우선시 한다.
- 문자열 값을 숫자 값으로 변환해서 비교를 수행한다.
- 따라서 상수를 문자열 타입인 칼럼과 비교하려면 문자로 표기해서 비교해야 한다.

#### 날짜
- MySQL에서는 정해진 형태의 날짜 포맷으로 표기하면 자동으로 변환해주기 때문에 STR_TO_DATE() 함수를 사용할 필요가 없다.
- `WHERE from_date = '2024-05-02'` 와 같이 사용하면 된다.

#### 불리언
- BOOL이나 BOOLEAN 타입이 있지만 사실 이것은 TINYINT 타입과 같다.
- 0은 FALSE, 1은 TRUE로 간주한다.
- 0과 1 이외의 값은 TRUE FALSE로 조회하면 조회되지 않는다.

#### MySQL 연산자

##### 동등(Equal) 비교(=. <=>)
- 동등 비교는 다른 DBMS와 마찬가지로 `=` 연산자를 사용한다.
- MySQL에서는 `<=>` 연산자를 사용해 동등비교 + NULL값 비교도 할 수 있다.
- NULL 은 is null 연산자 이외에는 비교할 방법이 없지만, `<=>` 연산자를 사용하면 NULL값을 비교할 수 있다.

##### 부정(Not-Equal) 비교(!=, <>)
- 부정 비교는 `!=` 또는 `<>` 연산자를 사용한다.

##### NOT 연산자(!)
- TRUE, FALSE 연산의 결과를 반대로 만다는 연산자로 `NOT`이나 `!`를 사용한다.

##### AND(&&)와 OR(||) 연산자
- 일반적인 DBMS 에서는 `AND`와 `OR` 연산자를 사용하지만 MySQL에서는 `&&`와 `||` 연산자도 사용할 수 있다.
- 하지만 `&&`와 `||` 연산자는 다른 용도로도 사용될 수 있어 `AND`와 `OR` 연산자를 사용하는 것이 가독성이 좋다.
- `AND`와 `OR` 연산자의 우선순위는 `AND`가 `OR`보다 높다.

##### 나누기(/, DIV)와 나머지(%, MOD) 연산자
- 나누기 연산자는 일반적으로 `/`를 사용한다.
- 나눈 몫의 정수 부분만 가져오려면 `DIV`를 사용한다.
- 나눈 나머지를 가져오는 연산자는 `%`와 `MOD`가 있다.

##### REGEXP 연산자
- 정규표현식을 사용해 문자열을 비교할 때 사용하는 연산자이다.
- `REGEXP` 연산자는 `RLIKE` 연산자로도 사용할 수 있다.
- `REGEXP` 연산자를 문자열 칼럼 비교에 사용할 때 인덱스 레인지 스캔을 사용할 수 없다.
- 가능하면 데이터 조회 범위를 줄일 수 있는 다른 조건과 함께 사용하길 권장한다.

##### LIKE 연산자
- DBMS 에서는 `REGEXP` 보다 `LIKE` 연산자를 더 많이 사용한다.
- `LIKE` 연산자는 와일드카드 문자를 사용해 문자열을 비교한다.

> - % : 0 또는 1개 이상의 모든 문자에 일치
> - _ : 정확히 1개 문자에 일치

- `REGEXP` 연산자는 일부만 일치해도 TRUE를 반환하지만 `LIKE`는 처음부터 끝까지 일치해야 TRUE를 반환한다.
- 와일드카드가 검색어 뒤쪽에 있다면 인덱스 레인지 스캔으로 사용할 수 있다.

##### BETWEEN 연산자
- `BETWEEN` 연산자는 크거나 같다와 작거나 같다 두 개의 연산자를 합친 연산자다.
- `BETWEEN` 연산자는 선형으로 인덱스를 검색하고, `IN` 은 동등 비교를 여러 번 수행하는 효과기 때문에 성능이 더 좋다.
- `BETWEEN 3 AND 5` 보다 `IN (3, 4, 5)`가 성능이 더 좋다.